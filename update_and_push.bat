@echo off
REM Batch-файл для додавання всіх змін, коміту та пушу на GitHub

REM Встановлюємо кодування консолі на UTF-8 для коректного відображення кирилиці (якщо потрібно)
REM chcp 65001
REM cls

echo ================================================================
echo == SCRIPT ДЛЯ ОНОВЛЕННЯ GIT-РЕПОЗИТОРІЮ ТА PUSH НА GITHUB ==
echo ================================================================
echo.

REM Перевірка, чи ми в Git-репозиторії (опціонально, але корисно)
git rev-parse --is-inside-work-tree >nul 2>&1
IF %ERRORLEVEL% NEQ 0 (
    echo Помилка: Поточна директорія не є Git-репозиторієм.
    echo Будь ласка, запустіть цей скрипт з кореневої папки вашого проекту.
    goto :eof
)

echo Поточний статус Git:
git status
echo ----------------------------------------------------------------
echo.

REM Запитуємо повідомлення для коміту
set "commit_message="
set /p commit_message="Введіть повідомлення для коміту (наприклад, 'Update feature X'): "

REM Якщо повідомлення порожнє, використовуємо стандартне
IF "%commit_message%"=="" (
    echo Використовується стандартне повідомлення для коміту.
    set commit_message="Routine update via batch script"
)
echo.

echo Додавання ВСІХ змінених та нових файлів до індексації (git add .)...
git add .
IF %ERRORLEVEL% NEQ 0 (
    echo !!! ПОМИЛКА під час виконання 'git add .' !!!
    echo Перевірте повідомлення вище.
    goto :error_exit
)
echo Файли успішно додано до індексації.
echo ----------------------------------------------------------------
echo.

echo Створення коміту з повідомленням: "%commit_message%"
git commit -m "%commit_message%"
IF %ERRORLEVEL% NEQ 0 (
    echo !!! ПОМИЛКА під час виконання 'git commit' !!!
    echo Можливо, не було змін для коміту після 'git add', або виникла інша помилка.
    echo Перевірте 'git status'.
    goto :error_exit
)
echo Коміт успішно створено.
echo ----------------------------------------------------------------
echo.

echo Завантаження змін на GitHub (гілка 'main' на 'origin')...
git push origin main
IF %ERRORLEVEL% NEQ 0 (
    echo !!! ПОМИЛКА під час виконання 'git push origin main' !!!
    echo Перевірте ваше інтернет-з'єднання, налаштування віддаленого репозиторію,
    echo або можливі конфлікти, якщо хтось інший робив зміни.
    goto :error_exit
)
echo Зміни успішно завантажено на GitHub!
echo ================================================================
echo.
echo Готово! Якщо налаштовано, Render має почати автоматичне розгортання.
echo ================================================================
echo.
goto :eof

:error_exit
echo.
echo !!! СКРИПТ ЗАВЕРШИВСЯ З ПОМИЛКОЮ !!!
echo Будь ласка, перегляньте повідомлення вище та виправте проблему вручну в консолі Git.
echo ================================================================

:eof
REM Залишаємо вікно відкритим, щоб побачити результат
pause